{{#if details.hasResult}}
  {{! IP Display }}
  {{#if (eq details.apiService "unified")}}
    {{#if details.limitHit}}
      <h1 class="p-title">{{fa-icon icon="info" fixedWidth=true}} Community API Limit Hit</h1>
      {{#if details.usingApiKey}}
        <div class="api-call-to-action alert alert-info">
          <a href="https://www.greynoise.io/pricing/" class="p-link">Get Started with GreyNoise Enterprise Here
            {{fa-icon icon="external-link-square" class="external-link-icon"}}</a>
        </div>
      {{else}}
        <div class="api-call-to-action alert alert-info">
          <a href="https://viz.greynoise.io/signup" class="p-link">Sign up for a free Community account to receive
            additional lookups and activate your GreyNoise Enterprise trial for full API and Visualizer access.
            {{fa-icon icon="external-link-square" class="external-link-icon"}}</a>
        </div>
      {{/if}}
    {{else}}
      {{#if (eq block.entity.type "IPv4")}}
        <div class="asset-container">
          {{#if details.ip}}
            <div>
              <a href="https://viz.greynoise.io/ip/{{details.ip}}" class="p-link">Pivot To GreyNoise Visualizer
                {{fa-icon icon="external-link-square" class="external-link-icon" fixedWidth=true}}</a>
            </div>
          {{/if}}
          {{! Ex RIOT part - Business Service Intelligence }}
          {{#if details.business_service_intelligence.found}}
            <div>
              <h1>Business Intelligence</h1>
            </div>
            <div>
              <span class="p-key"> Trust Level: </span>
              <span class="p-value">{{details.business_service_intelligence.trust_level}}</span>
            </div>
            <div>
              <span class="p-key"> Category: </span>
              <span class="p-value">{{details.business_service_intelligence.category}}</span>
            </div>
            <div>
              <span class="p-key"> Name: </span>
              <span class="p-value">{{details.business_service_intelligence.name}}</span>
            </div>
            <div>
              <span class="p-key"> Description: </span>
              <span class="p-value">{{details.business_service_intelligence.description}}</span>
            </div>
            <div>
              <span class="p-key"> Explanation: </span>
              <span class="p-value">{{details.business_service_intelligence.explanation}}</span>
            </div>
            <div>
              <span class="p-key"> Updated Date: </span>
              <span class="p-value">{{moment-format
                  details.business_service_intelligence.last_updated
                  "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                }}</span>
            </div>
            <div>
              <span class="p-key"> Reference: </span>
              <span class="p-value"><a
                  href="{{details.business_service_intelligence.reference}}"
                  class="p-link"
                  target="_blank"
                >{{details.business_service_intelligence.reference}}</a></span>
            </div>
          {{/if}}

          {{! Ex NOISE part - Internet Scanner Intelligence }}
          {{#if details.internet_scanner_intelligence.found}}
            <h1>IP Scanner</h1>
            {{#if details.internet_scanner_intelligence.tags}}
              <h2 class="p-title">
                {{fa-icon "link" fixedWidth=true}}
                Associations
              </h2>
              {{#each pagedAssociations as |tag|}}
                <div class="mb-3">
                  <div>
                    <span class="p-key">Name: </span>
                    <span class="p-value">{{tag.name}}</span>
                  </div>
                  <div>
                    <span class="p-key">Description: </span>
                    <span class="p-value">{{tag.description}}</span>
                  </div>
                  <div>
                    <span class="p-key">Category: </span>
                    <span class="p-value">{{tag.category}}</span>
                  </div>
                  <div>
                    <span class="p-key">Intent: </span>
                    <span class="p-value">{{tag.intention}}</span>
                  </div>
                  {{#if tag.cves}}
                    <div>
                      <span class="p-key">CVEs: </span>
                      <span class="p-value">
                        {{#each tag.cves as |cve index|}}
                          {{cve}}{{#if (not (eq (sub tag.cves.length 1) index))}}, {{/if}}
                        {{/each}}
                      </span>
                    </div>
                  {{/if}}
                  <div>
                    <span class="p-key">Recommended Block: </span>
                    <span class="p-value">{{tag.recommend_block}}</span>
                  </div>
                </div>
              {{/each}}
              {{#if (gt details.internet_scanner_intelligence.tags.length associationsPageSize)}}
                <div class="paging-bar">
                  <button
                    class="btn paging-btn"
                    {{action "firstAssociationsPage"}}
                    disabled={{isPrevAssociationsButtonsDisabled}}
                  >
                    {{fa-icon icon="angle-double-left" fixedWidth=false}}
                  </button>
                  <button
                    class="btn paging-btn"
                    {{action "prevAssociationsPage"}}
                    disabled={{isPrevAssociationsButtonsDisabled}}
                  >
                    {{fa-icon icon="angle-left" fixedWidth=false}}
                  </button>
                  <div class="paging-info">
                    {{associationsStartItem}}
                    -
                    {{associationsEndItem}}
                    of
                    {{details.internet_scanner_intelligence.tags.length}}
                  </div>
                  <button
                    class="btn paging-btn"
                    {{action "nextAssociationsPage"}}
                    disabled={{isNextAssociationsButtonDisabled}}
                  >
                    {{fa-icon icon="angle-right" fixedWidth=false}}
                  </button>
                  <button
                    class="btn paging-btn"
                    {{action "lastAssociationsPage"}}
                    disabled={{isNextAssociationsButtonDisabled}}
                  >
                    {{fa-icon icon="angle-double-right" fixedWidth=false}}
                  </button>
                </div>
              {{/if}}
              <h2 class="p-title">
                {{fa-icon "eye" fixedWidth=true}}
                Context Information
              </h2>
              {{#if details.internet_scanner_intelligence.first_seen}}
                <div>
                  <span class="p-key">First Seen: </span>
                  <span class="p-value">{{moment-format
                      details.internet_scanner_intelligence.first_seen
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.last_seen}}
                <div>
                  <span class="p-key">Last Seen: </span>
                  <span class="p-value">{{moment-format
                      details.internet_scanner_intelligence.last_seen
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}</span>
                </div>
              {{/if}}
              <div>
                <span class="p-key">Found: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.found}}</span>
              </div>
              {{#if details.internet_scanner_intelligence.actor}}
                <div>
                  <span class="p-key">Actor: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.actor}}</span>
                </div>
              {{/if}}
              <div>
                <span class="p-key">Spoofable: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.spoofable}}</span>
              </div>
              {{#if details.internet_scanner_intelligence.classification}}
                <div>
                  <span class="p-key">Classification: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.classification}}</span>
                </div>
              {{/if}}
              <div>
                <span class="p-key">Bot: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.bot}}</span>
              </div>
              <div>
                <span class="p-key">VPN: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.vpn}}</span>
              </div>
              {{#if details.internet_scanner_intelligence.vpn_service}}
                <div>
                  <span class="p-key">VPN Service: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.vpn_service}}</span>
                </div>
              {{/if}}
              <div>
                <span class="p-key">Tor: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.tor}}</span>
              </div>
              {{#if details.internet_scanner_intelligence.cves}}
                <div>
                  <span class="p-key">CVEs ({{details.internet_scanner_intelligence.cves.length}})</span>
                  <div class="p-scrollable-table">
                    <table class="p-table">
                      <tbody>
                        {{#each details.internet_scanner_intelligence.cves as |cve|}}
                          <tr>
                            <td>{{cve}}</td>
                          </tr>
                        {{/each}}
                      </tbody>
                    </table>
                  </div>
                </div>
              {{/if}}
              <h2 class="p-title">
                {{fa-icon "table" fixedWidth=true}}
                Metadata
              </h2>
              {{#if details.internet_scanner_intelligence.metadata.asn}}
                <div>
                  <span class="p-key">ASN: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.asn}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.source_country}}
                <div>
                  <span class="p-key">Source Country: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.source_country}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.source_country_code}}
                <div>
                  <span class="p-key">Source Country Code: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.source_country_code}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.source_city}}
                <div>
                  <span class="p-key">Source City: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.source_city}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.domain}}
                <div>
                  <span class="p-key">Domain: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.domain}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.organization}}
                <div>
                  <span class="p-key">Organization: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.organization}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.category}}
                <div>
                  <span class="p-key">Category: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.category}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.rdns}}
                <div>
                  <span class="p-key">RDNS: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.rdns}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.sensor_count}}
                <div>
                  <span class="p-key">Sensor Count: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.sensor_count}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.sensor_hits}}
                <div>
                  <span class="p-key">Sensor Hits: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.sensor_hits}}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.region}}
                <div>
                  <span class="p-key">Region: </span>
                  <span class="p-value">{{details.internet_scanner_intelligence.metadata.region}}</span>
                </div>
              {{/if}}
              <div>
                <span class="p-key">Mobile: </span>
                <span class="p-value">{{details.internet_scanner_intelligence.metadata.mobile}}</span>
              </div>
              {{#if details.internet_scanner_intelligence.last_seen_timestamp}}
                <div>
                  <span class="p-key">Last Seen Timestamp: </span>
                  <span class="p-value">
                    {{moment-format
                      details.internet_scanner_intelligence.last_seen_timestamp
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}
                  </span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.last_seen_malicious}}
                <div>
                  <span class="p-key">Last Seen Malicious: </span>
                  <span class="p-value">{{moment-format
                      details.internet_scanner_intelligence.last_seen_malicious
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.last_seen_suspicious}}
                <div>
                  <span class="p-key">Last Seen Suspicious: </span>
                  <span class="p-value">{{moment-format
                      details.internet_scanner_intelligence.last_seen_suspicious
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.last_seen_benign}}
                <div>
                  <span class="p-key">Last Seen Benign: </span>
                  <span class="p-value">{{moment-format
                      details.internet_scanner_intelligence.last_seen_benign
                      "ddd, DD MMM YYYY HH:mm:ss [GMT]"
                    }}</span>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.metadata.destination_countries}}
                <span class="p-key">Destination Countries ({{details.internet_scanner_intelligence.metadata.destination_countries.length}})</span>
                <div class="p-scrollable-table">
                  <table class="p-table">
                    <tbody>
                      {{#each details.internet_scanner_intelligence.metadata.destination_countries as |country|}}
                        <tr>
                          <td>{{country}}</td>
                        </tr>
                      {{/each}}
                    </tbody>
                  </table>
                </div>
              {{/if}}
              {{#if details.internet_scanner_intelligence.raw_data.scan}}
                <span class="p-key">Port & Protocol ({{details.internet_scanner_intelligence.raw_data.scan.length}})</span>
                <div class="p-scrollable-table">
                  <table class="p-table">
                    <tbody>
                      {{#each details.internet_scanner_intelligence.raw_data.scan as |scan|}}
                        <tr>
                          <td>{{scan.port}}</td>
                          <td>{{scan.protocol}}</td>
                        </tr>
                      {{/each}}
                    </tbody>
                  </table>
                </div>
              {{/if}}
            {{/if}}
          {{/if}}

          <div id={{concat "community-container-" uniqueIdPrefix}}>
            <h2 class="p-title">{{fa-icon "clipboard" fixedWidth=true}} GreyNoise Community Summary</h2>
            <div class="mb-2">
              {{#if details.business_service_intelligence.found}}
                <span>
                  The IP
                  <strong>{{block.entity.value}}</strong>
                  has not been observed scanning the internet by GreyNoise. It is part of the
                  <strong>RIOT</strong>
                  project, which identifies IPs from known benign services and organizations that commonly cause false
                  positives in network security and threat intelligence products. The collection of IPs in RIOT is
                  continually curated and verified to provide accurate results.
                </span>
              {{/if}}
              {{#if details.internet_scanner_intelligence.found}}
                <div class="{{if details.business_service_intelligence.found 'mt-2'}}">

                  {{#if (eq details.internet_scanner_intelligence.classification "benign")}}
                    A benign classification from GreyNoise indicates this IP belongs to a legitimate service and is not
                    considered malicious.
                  {{/if}}
                  {{#if (eq details.internet_scanner_intelligence.classification "malicious")}}
                    GreyNoise classified the IP as malicious because it is not classified as benign and has one or more
                    malicious tags associated with it. It is still considered Internet background noise since it is
                    scanning the entire Internet and NOT targeting you specifically.
                  {{/if}}
                  {{#if (eq details.internet_scanner_intelligence.classification "unknown")}}
                    GreyNoise classified the IP as unknown because it could not be classified as malicious or benign and
                    has unknown intent. It is still considered Internet background noise since it is scanning the entire
                    internet and NOT targeting you specifically.
                  {{/if}}
                </div>
              {{/if}}
            </div>
            {{#unless details.usingApiKey}}
              <div class="api-call-to-action alert alert-info">
                {{fa-icon icon="gift" fixedWidth=true}}
                <a href="https://viz.greynoise.io/signup">
                  Activate your free 14-day trial of GreyNoise. You'll have full API access and Visualizer features
                  during the trial.
                  {{fa-icon icon="external-link-square" class="external-link-icon" fixedWidth=true}}</a>
              </div>
            {{/unless}}
          </div>
        </div>
      {{/if}}

      {{! CVE Information }}
      {{#if (eq block.entity.type "cve")}}
        <div class="asset-container">
          <h1>Common Vulnerabilities and Exposures</h1>
          <h2 class="p-title">
            {{fa-icon "eye" fixedWidth=true}}
            Context Information
          </h2>
          <div>
            <span class="p-key">Description:</span>
            <span class="p-value">{{details.details.vulnerability_description}}</span>
          </div>
          <div>
            <span class="p-key">CVSS Score:</span>
            <span class="p-value">{{details.details.cve_cvss_score}}</span>
          </div>
          <div>
            <span class="p-key">EPSS Score:</span>
            <span class="p-value">{{details.exploitation_details.epss_score}}</span>
          </div>
          <div>
            <span class="p-key">Attack Vector:</span>
            <span class="p-value">{{#if
                details.exploitation_details.attack_vector
              }}{{details.exploitation_details.attack_vector}}{{else}}Unknown{{/if}}</span>
          </div>
          <div>
            <span class="p-key">Published to NVD:</span>
            <span class="p-value">{{details.details.published_to_nist_nvd}}</span>
          </div>
          <h2 class="p-title">
            {{fa-icon "clock" fixedWidth=true}}
            Timeline
          </h2>
          <div>
            <span class="p-key">Published:</span>
            <span class="p-value">{{moment-format
                details.timeline.cve_published_date
                "ddd, DD MMM YYYY HH:mm:ss [GMT]"
              }}</span>
          </div>
          <div>
            <span class="p-key">Last Modified:</span>
            <span class="p-value">{{moment-format
                details.timeline.cve_last_updated_date
                "ddd, DD MMM YYYY HH:mm:ss [GMT]"
              }}</span>
          </div>
        </div>
      {{/if}}
    {{/if}}
  {{/if}}
{{else}}
  {{#if (eq block.entity.type "IPv4")}}
    <span>IP address has not been seen.</span>
  {{else if (eq block.entity.type "cve")}}
    <span>CVE has not been seen.</span>
  {{/if}}
{{/if}}